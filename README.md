# Opendata CMS

Този проект съдържа кода на сайта, задвижващ секция "Новини и информация" на [националния портал за отворени данни](https://opendata.government.bg). Базиран е на [WordPress](https://wordpress.org/) и е съставен основно от responsive тема, носеща визията на портала, плюс документация, ръководства и скриптове за инсталация и създаване или възстановяване на резервни копия.

## Инсталация

Проектът има инсталационен скрипт за Linux и Unix операционни системи, автоматизиращ процедурата.

Инструкциите за инсталация се намират в [install/README.md](install/README.md).

## Редактиране на темата и създаване на нова версия

Темата в хранилището използва [sass](http://sass-lang.com/) и [node.js](https://nodejs.org/en/) и за да бъде подготвена за локална разработка са нужни следните стъпки:
*Предполага се че вече имате локална WordPress среда. Ако нямате, сега е момента да създадете - например с [VVV](https://github.com/Varying-Vagrant-Vagrants/VVV).*

**Подготвяне на git:**
  - Отворете директорията на локалната Ви Wordpress инсталация(папката, която съдържа ```wp-content```) и създайте празно гит хранилище - ```git init```.
  - Добавете текущото хранилище като 'remote' - ```git add remote origin https://github.com/governmentbg/opendata-cms.git```.
  - ``` git fetch --all ``` - Сваляме съдържанието от текущото хранилище, без да правим опит за 'merge' или 'rebase'.
  - ``` git reset --hard origin/master ``` - Уеднаквяваме локалния 'master', заедно с файловете, с отдалеченото хранилище

*На този етап ще имате WordPress инсталация, с темата във вида ѝ точно какъвто е в GitHub хранилището, както и backup-restore и install скриптовете. ```git status``` би трябвало да връща ```nothing to commit, working directory clean```. Темата все още няма компилирани нужните ѝ ресурси, и съответно няма да има стилове. *

**Инсталиране и компилиране на ресурсите(assets) на темата**
  - Отворете директорията на темата (```/wp-content/themes/opendata-wp/```) и изпълнете ```npm install```. Това ще генерира нужните ресурси, така че темата да работи нормално.

  - След редактиране на файловете, изпълнявайте ```npm run build```, за да бъдат генерирани отново изходните файлове, така че да се отразят промените Ви в тях. Друга опция е изпълняването на ```npm run watch``` по време на работата по сайта, така че изходните файлове да бъдат генерирани автоматично при всяко запазване на файла, който редатирате в редактора си.

**Създаване на нов release**
  - След като промените Ви са готови, изпълнете ```npm run package```, който ще генерира .zip пакет с темата(```/wp-content/themes/opendata-wp/packaged/```), готова за инсталиране на който и да е WordPress сайт.

  - Накрая - създайте нов github release, с новата версия на темата, качвайки генерираният .zip пакет на темата като ресурс при създаването на github release. По този начин install скрипта ще сваля винаги най-новата налична версия на темата.

## Сигнализация за проблеми

Ако забележите проблем, или искате да предложите подобрение, [може да направите това в секция "Issues"](https://github.com/governmentbg/opendata-cms/issues).

## Лиценз

Този проект се разпространява под GNU GPL лиценз. Може да намерите пълния текст на лицензионното споразумение във файла [LICENSE](LICENSE).
